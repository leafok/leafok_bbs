# Load necessary modules (often pre-loaded in httpd image, but good practice)
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so

# Ensure authorization headers are passed correctly
SetEnvIfNoCase ^Authorization$ "(.+)" HTTP_AUTHORIZATION=$1

# Define the listening port
Listen *:8081

<VirtualHost *:8081>
    ServerName localhost
    ServerAdmin root@localhost
    DocumentRoot /var/www/html

    <Directory "/var/www/html/">
        DirectoryIndex index.php index.html
        AllowOverride None
        Options FollowSymLinks
        Require all granted
    </Directory>

    <Directory "/var/www/html/conf/">
        AllowOverride None
        Order allow,deny
        Deny from all
    </Directory>

    # Pass PHP scripts to the php-fpm service
    <FilesMatch \.php$>
        # Use the service name 'php' as the hostname, port 9000 is the default FPM port
        SetHandler "proxy:fcgi://php:9000"
    </FilesMatch>

    ErrorLog logs/leafok_bbs_error_log
    CustomLog logs/leafok_bbs_access_log combined
</VirtualHost>
